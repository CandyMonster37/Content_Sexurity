C:\ProgramData\Anaconda3\python.exe C:/Users/CandyMonster/Desktop/EXPCLASS/内容安全/final/train.py
==> Preparing data...
Make data sets successfully!
kinds: 2
data nums: 2511
train nums: 2008
test nums: 251
dev nums: 252
Make dataloader successfully!
Data prepared!
==> Building and training model...
Begin at:  2021-06-09 15:17:29
  0%|          | 0/100 [00:00<?, ?it/s]train AUC: 0.64921 ACC: 0.75647
test AUC: 0.68517 ACC: 0.8008
dev AUC: 0.7206 ACC: 0.79518
  1%|          | 1/100 [00:51<1:25:18, 51.71s/it]train AUC: 0.53073 ACC: 0.59811
test AUC: 0.57453 ACC: 0.62151
  2%|▏         | 2/100 [01:39<1:20:33, 49.32s/it]dev AUC: 0.47628 ACC: 0.65863
train AUC: 0.60312 ACC: 0.78137
test AUC: 0.59711 ACC: 0.80876
dev AUC: 0.48884 ACC: 0.73494
  3%|▎         | 3/100 [02:27<1:19:00, 48.87s/it]train AUC: 0.63975 ACC: 0.80179
test AUC: 0.57522 ACC: 0.8008
  4%|▍         | 4/100 [03:16<1:18:16, 48.92s/it]dev AUC: 0.52874 ACC: 0.80321
train AUC: 0.68349 ACC: 0.80179
test AUC: 0.70299 ACC: 0.8008
  5%|▌         | 5/100 [04:06<1:18:14, 49.41s/it]dev AUC: 0.69467 ACC: 0.7992
train AUC: 0.7439 ACC: 0.80179
test AUC: 0.85104 ACC: 0.8008
  6%|▌         | 6/100 [04:57<1:17:46, 49.64s/it]dev AUC: 0.70864 ACC: 0.7992
train AUC: 0.72198 ACC: 0.77341
test AUC: 0.84328 ACC: 0.79681
dev AUC: 0.64965 ACC: 0.63855
  7%|▋         | 7/100 [05:46<1:16:42, 49.48s/it]train AUC: 0.74505 ACC: 0.80976
test AUC: 0.79493 ACC: 0.80876
dev AUC: 0.79829 ACC: 0.79116
  8%|▊         | 8/100 [06:35<1:15:52, 49.49s/it]train AUC: 0.77232 ACC: 0.80229
test AUC: 0.80507 ACC: 0.8008
  9%|▉         | 9/100 [07:25<1:15:21, 49.69s/it]dev AUC: 0.77809 ACC: 0.7992
train AUC: 0.7827 ACC: 0.8247
test AUC: 0.83303 ACC: 0.88446
 10%|█         | 10/100 [08:16<1:15:12, 50.14s/it]dev AUC: 0.73377 ACC: 0.80321
train AUC: 0.75974 ACC: 0.82122
test AUC: 0.89721 ACC: 0.83267
dev AUC: 0.75598 ACC: 0.77108
 11%|█         | 11/100 [09:08<1:14:51, 50.46s/it]train AUC: 0.7819 ACC: 0.82271
test AUC: 0.88388 ACC: 0.86056
dev AUC: 0.79889 ACC: 0.81124
 12%|█▏        | 12/100 [10:01<1:15:26, 51.43s/it]train AUC: 0.78073 ACC: 0.81524
test AUC: 0.91861 ACC: 0.82869
dev AUC: 0.74915 ACC: 0.76305
 13%|█▎        | 13/100 [10:52<1:14:25, 51.33s/it]train AUC: 0.78013 ACC: 0.81125
test AUC: 0.88129 ACC: 0.86056
 14%|█▍        | 14/100 [11:44<1:13:33, 51.32s/it]dev AUC: 0.79337 ACC: 0.78313
train AUC: 0.79944 ACC: 0.82171
test AUC: 0.85234 ACC: 0.86853
 15%|█▌        | 15/100 [12:34<1:12:26, 51.14s/it]dev AUC: 0.78513 ACC: 0.75904
train AUC: 0.74986 ACC: 0.81873
test AUC: 0.72896 ACC: 0.81673
 16%|█▌        | 16/100 [13:25<1:11:12, 50.87s/it]dev AUC: 0.74402 ACC: 0.73092
train AUC: 0.77231 ACC: 0.7988
test AUC: 0.88129 ACC: 0.84462
dev AUC: 0.75819 ACC: 0.74297
 17%|█▋        | 17/100 [14:16<1:10:31, 50.99s/it]train AUC: 0.7823 ACC: 0.81524
test AUC: 0.87413 ACC: 0.87649
 18%|█▊        | 18/100 [15:06<1:09:17, 50.70s/it]dev AUC: 0.74583 ACC: 0.71888
train AUC: 0.75224 ACC: 0.81574
test AUC: 0.81552 ACC: 0.81673
 19%|█▉        | 19/100 [15:56<1:08:06, 50.45s/it]dev AUC: 0.7392 ACC: 0.74699
train AUC: 0.7648 ACC: 0.80677
test AUC: 0.79781 ACC: 0.81275
 20%|██        | 20/100 [16:46<1:07:00, 50.25s/it]dev AUC: 0.7802 ACC: 0.80321
train AUC: 0.74161 ACC: 0.81524
test AUC: 0.88975 ACC: 0.85259
 21%|██        | 21/100 [17:35<1:05:58, 50.10s/it]dev AUC: 0.66693 ACC: 0.73896
train AUC: 0.7768 ACC: 0.81873
test AUC: 0.84159 ACC: 0.85657
dev AUC: 0.77819 ACC: 0.7992
 22%|██▏       | 22/100 [18:25<1:04:53, 49.92s/it]train AUC: 0.78867 ACC: 0.81972
test AUC: 0.86299 ACC: 0.84861
dev AUC: 0.79307 ACC: 0.77912
 23%|██▎       | 23/100 [19:15<1:04:16, 50.08s/it]train AUC: 0.65275 ACC: 0.8003
test AUC: 0.7594 ACC: 0.8008
 24%|██▍       | 24/100 [20:05<1:03:24, 50.07s/it]dev AUC: 0.65749 ACC: 0.79116
train AUC: 0.77032 ACC: 0.81524
test AUC: 0.8995 ACC: 0.84462
 25%|██▌       | 25/100 [20:55<1:02:25, 49.94s/it]dev AUC: 0.8004 ACC: 0.81124
train AUC: 0.78475 ACC: 0.81175
test AUC: 0.86776 ACC: 0.84064
 26%|██▌       | 26/100 [21:45<1:01:33, 49.91s/it]dev AUC: 0.78975 ACC: 0.80723
train AUC: 0.79079 ACC: 0.82968
test AUC: 0.86577 ACC: 0.86056
 27%|██▋       | 27/100 [22:36<1:01:04, 50.20s/it]dev AUC: 0.80844 ACC: 0.7992
train AUC: 0.78173 ACC: 0.81922
test AUC: 0.89313 ACC: 0.80478
 28%|██▊       | 28/100 [23:26<1:00:06, 50.09s/it]dev AUC: 0.81859 ACC: 0.79518
train AUC: 0.79794 ACC: 0.81922
test AUC: 0.85045 ACC: 0.84064
 29%|██▉       | 29/100 [24:15<59:09, 50.00s/it]  dev AUC: 0.79387 ACC: 0.7992
train AUC: 0.79071 ACC: 0.81275
test AUC: 0.83542 ACC: 0.84064
dev AUC: 0.79347 ACC: 0.79116
 30%|███       | 30/100 [25:05<58:13, 49.91s/it]train AUC: 0.78936 ACC: 0.82321
test AUC: 0.87522 ACC: 0.85259
 31%|███       | 31/100 [25:58<58:36, 50.96s/it]dev AUC: 0.83427 ACC: 0.80723
train AUC: 0.78878 ACC: 0.82769
test AUC: 0.8208 ACC: 0.82869
dev AUC: 0.77799 ACC: 0.7751
 32%|███▏      | 32/100 [26:51<58:20, 51.48s/it]train AUC: 0.8005 ACC: 0.8257
test AUC: 0.89473 ACC: 0.87251
 33%|███▎      | 33/100 [27:43<57:39, 51.64s/it]dev AUC: 0.79678 ACC: 0.77108
train AUC: 0.78001 ACC: 0.8252
test AUC: 0.84776 ACC: 0.82869
 34%|███▍      | 34/100 [28:38<57:48, 52.55s/it]dev AUC: 0.80754 ACC: 0.78313
train AUC: 0.79121 ACC: 0.82221
test AUC: 0.8598 ACC: 0.82072
dev AUC: 0.82442 ACC: 0.78715
 35%|███▌      | 35/100 [29:31<57:00, 52.62s/it]train AUC: 0.80839 ACC: 0.82271
test AUC: 0.80279 ACC: 0.82869
dev AUC: 0.80141 ACC: 0.78715
 36%|███▌      | 36/100 [30:23<55:56, 52.45s/it]train AUC: 0.79806 ACC: 0.81125
test AUC: 0.84139 ACC: 0.8247
 37%|███▋      | 37/100 [31:14<54:42, 52.11s/it]dev AUC: 0.77618 ACC: 0.71888
train AUC: 0.8058 ACC: 0.82271
test AUC: 0.84448 ACC: 0.8247
 38%|███▊      | 38/100 [32:05<53:39, 51.93s/it]dev AUC: 0.8191 ACC: 0.78313
train AUC: 0.7832 ACC: 0.81225
test AUC: 0.87254 ACC: 0.84462
 39%|███▉      | 39/100 [32:57<52:35, 51.73s/it]dev AUC: 0.74724 ACC: 0.78313
train AUC: 0.77523 ACC: 0.80329
test AUC: 0.74746 ACC: 0.78884
dev AUC: 0.80432 ACC: 0.76707
 40%|████      | 40/100 [33:51<52:29, 52.50s/it]train AUC: 0.79544 ACC: 0.82221
test AUC: 0.87771 ACC: 0.85259
 41%|████      | 41/100 [34:42<51:17, 52.17s/it]dev AUC: 0.8199 ACC: 0.80321
train AUC: 0.80736 ACC: 0.83367
test AUC: 0.86766 ACC: 0.86853
 42%|████▏     | 42/100 [35:33<50:00, 51.72s/it]dev AUC: 0.84201 ACC: 0.81526
train AUC: 0.81178 ACC: 0.82122
test AUC: 0.89731 ACC: 0.86056
dev AUC: 0.83055 ACC: 0.76305
 43%|████▎     | 43/100 [36:24<48:48, 51.39s/it]train AUC: 0.82382 ACC: 0.83566
test AUC: 0.87791 ACC: 0.87251
 44%|████▍     | 44/100 [37:14<47:44, 51.14s/it]dev AUC: 0.83709 ACC: 0.83534
train AUC: 0.78494 ACC: 0.8262
test AUC: 0.87134 ACC: 0.86454
 45%|████▌     | 45/100 [38:05<46:42, 50.96s/it]dev AUC: 0.86231 ACC: 0.82329
train AUC: 0.77764 ACC: 0.82968
test AUC: 0.86468 ACC: 0.83665
 46%|████▌     | 46/100 [38:57<46:16, 51.41s/it]dev AUC: 0.7601 ACC: 0.77108
train AUC: 0.77581 ACC: 0.82371
test AUC: 0.86547 ACC: 0.86454
dev AUC: 0.72583 ACC: 0.77108
 47%|████▋     | 47/100 [39:49<45:34, 51.59s/it]train AUC: 0.78459 ACC: 0.78835
test AUC: 0.89602 ACC: 0.78486
 48%|████▊     | 48/100 [40:41<44:40, 51.55s/it]dev AUC: 0.69055 ACC: 0.63454
train AUC: 0.82591 ACC: 0.84014
test AUC: 0.82945 ACC: 0.87251
dev AUC: 0.83246 ACC: 0.80321
 49%|████▉     | 49/100 [41:32<43:50, 51.58s/it]train AUC: 0.81294 ACC: 0.83167
test AUC: 0.81502 ACC: 0.82869
 50%|█████     | 50/100 [42:24<42:58, 51.57s/it]dev AUC: 0.82462 ACC: 0.80321
train AUC: 0.82217 ACC: 0.8262
test AUC: 0.84935 ACC: 0.82869
dev AUC: 0.83879 ACC: 0.81526
 51%|█████     | 51/100 [43:15<42:05, 51.55s/it]train AUC: 0.82058 ACC: 0.83815
test AUC: 0.84617 ACC: 0.84462
 52%|█████▏    | 52/100 [44:07<41:18, 51.64s/it]dev AUC: 0.8395 ACC: 0.81526
train AUC: 0.78894 ACC: 0.8257
test AUC: 0.84965 ACC: 0.86056
dev AUC: 0.86533 ACC: 0.85141
 53%|█████▎    | 53/100 [44:58<40:19, 51.49s/it]train AUC: 0.8231 ACC: 0.82819
test AUC: 0.84776 ACC: 0.85259
dev AUC: 0.79126 ACC: 0.81124
 54%|█████▍    | 54/100 [45:49<39:12, 51.14s/it]train AUC: 0.76866 ACC: 0.78088
test AUC: 0.87552 ACC: 0.82869
dev AUC: 0.72915 ACC: 0.67068
 55%|█████▌    | 55/100 [46:40<38:19, 51.11s/it]train AUC: 0.80665 ACC: 0.8247
test AUC: 0.84896 ACC: 0.83267
 56%|█████▌    | 56/100 [47:33<37:56, 51.74s/it]dev AUC: 0.79578 ACC: 0.78715
train AUC: 0.79215 ACC: 0.83317
test AUC: 0.80617 ACC: 0.83665
 57%|█████▋    | 57/100 [48:26<37:24, 52.20s/it]dev AUC: 0.82322 ACC: 0.79116
train AUC: 0.78413 ACC: 0.79283
test AUC: 0.8796 ACC: 0.87649
 58%|█████▊    | 58/100 [49:20<36:46, 52.54s/it]dev AUC: 0.80864 ACC: 0.7751
train AUC: 0.80546 ACC: 0.82719
test AUC: 0.84537 ACC: 0.84462
 59%|█████▉    | 59/100 [50:13<36:09, 52.91s/it]dev AUC: 0.81236 ACC: 0.81526
train AUC: 0.81872 ACC: 0.81922
test AUC: 0.86995 ACC: 0.83267
 60%|██████    | 60/100 [51:07<35:28, 53.21s/it]dev AUC: 0.85739 ACC: 0.76305
train AUC: 0.83462 ACC: 0.82719
test AUC: 0.88507 ACC: 0.83665
dev AUC: 0.84734 ACC: 0.76707
 61%|██████    | 61/100 [52:00<34:25, 52.96s/it]train AUC: 0.82947 ACC: 0.84014
test AUC: 0.85433 ACC: 0.86056
dev AUC: 0.83146 ACC: 0.79116
 62%|██████▏   | 62/100 [52:54<33:51, 53.47s/it]train AUC: 0.82196 ACC: 0.83416
test AUC: 0.83244 ACC: 0.84064
 63%|██████▎   | 63/100 [53:48<33:02, 53.58s/it]dev AUC: 0.83487 ACC: 0.74297
train AUC: 0.81879 ACC: 0.83665
test AUC: 0.85672 ACC: 0.9004
 64%|██████▍   | 64/100 [54:41<32:05, 53.50s/it]dev AUC: 0.81779 ACC: 0.80321
train AUC: 0.82485 ACC: 0.83914
test AUC: 0.83721 ACC: 0.83665
dev AUC: 0.83859 ACC: 0.81928
 65%|██████▌   | 65/100 [55:35<31:07, 53.36s/it]train AUC: 0.81914 ACC: 0.8262
test AUC: 0.83393 ACC: 0.86853
 66%|██████▌   | 66/100 [56:28<30:16, 53.41s/it]dev AUC: 0.84583 ACC: 0.83936
train AUC: 0.80778 ACC: 0.83616
test AUC: 0.82308 ACC: 0.83665
dev AUC: 0.82492 ACC: 0.78313
 67%|██████▋   | 67/100 [57:21<29:17, 53.26s/it]train AUC: 0.82713 ACC: 0.83367
test AUC: 0.85393 ACC: 0.85657
 68%|██████▊   | 68/100 [58:13<28:08, 52.75s/it]dev AUC: 0.86111 ACC: 0.85141
train AUC: 0.82389 ACC: 0.83715
test AUC: 0.85701 ACC: 0.84861
dev AUC: 0.84402 ACC: 0.83936
 69%|██████▉   | 69/100 [59:05<27:11, 52.62s/it]train AUC: 0.76633 ACC: 0.83217
test AUC: 0.65552 ACC: 0.77291
dev AUC: 0.80181 ACC: 0.77912
 70%|███████   | 70/100 [59:58<26:19, 52.66s/it]train AUC: 0.82698 ACC: 0.82669
test AUC: 0.8999 ACC: 0.88845
 71%|███████   | 71/100 [1:00:50<25:28, 52.72s/it]dev AUC: 0.82854 ACC: 0.81124
train AUC: 0.83242 ACC: 0.83815
test AUC: 0.88756 ACC: 0.88048
dev AUC: 0.84764 ACC: 0.82329
 72%|███████▏  | 72/100 [1:01:43<24:36, 52.75s/it]train AUC: 0.80711 ACC: 0.81026
test AUC: 0.8601 ACC: 0.82869
 73%|███████▎  | 73/100 [1:02:35<23:33, 52.34s/it]dev AUC: 0.79266 ACC: 0.78715
train AUC: 0.82928 ACC: 0.82918
test AUC: 0.87184 ACC: 0.89641
 74%|███████▍  | 74/100 [1:03:26<22:32, 52.02s/it]dev AUC: 0.81327 ACC: 0.80723
train AUC: 0.82367 ACC: 0.83765
test AUC: 0.89682 ACC: 0.87649
dev AUC: 0.82975 ACC: 0.81124
 75%|███████▌  | 75/100 [1:04:17<21:32, 51.68s/it]train AUC: 0.8219 ACC: 0.83566
test AUC: 0.81542 ACC: 0.84462
 76%|███████▌  | 76/100 [1:05:07<20:32, 51.35s/it]dev AUC: 0.83899 ACC: 0.85944
train AUC: 0.70878 ACC: 0.80229
test AUC: 0.7608 ACC: 0.8008
 77%|███████▋  | 77/100 [1:05:59<19:43, 51.44s/it]dev AUC: 0.64905 ACC: 0.7992
train AUC: 0.76905 ACC: 0.81375
test AUC: 0.8599 ACC: 0.86853
dev AUC: 0.79457 ACC: 0.7992
 78%|███████▊  | 78/100 [1:06:51<18:55, 51.61s/it]train AUC: 0.7721 ACC: 0.80578
test AUC: 0.78627 ACC: 0.88048
 79%|███████▉  | 79/100 [1:07:43<18:04, 51.65s/it]dev AUC: 0.79568 ACC: 0.82731
train AUC: 0.80927 ACC: 0.82271
test AUC: 0.86189 ACC: 0.80478
 80%|████████  | 80/100 [1:08:34<17:11, 51.60s/it]dev AUC: 0.83638 ACC: 0.81928
train AUC: 0.80194 ACC: 0.8242
test AUC: 0.81234 ACC: 0.80876
 81%|████████  | 81/100 [1:09:26<16:20, 51.59s/it]dev AUC: 0.81156 ACC: 0.81526
train AUC: 0.81176 ACC: 0.83317
test AUC: 0.8394 ACC: 0.8247
 82%|████████▏ | 82/100 [1:10:17<15:26, 51.47s/it]dev AUC: 0.80734 ACC: 0.79518
train AUC: 0.81255 ACC: 0.84064
test AUC: 0.82408 ACC: 0.83665
 83%|████████▎ | 83/100 [1:11:09<14:35, 51.52s/it]dev AUC: 0.83377 ACC: 0.81526
train AUC: 0.80403 ACC: 0.81922
test AUC: 0.84468 ACC: 0.80876
dev AUC: 0.79296 ACC: 0.79518
 84%|████████▍ | 84/100 [1:12:00<13:44, 51.51s/it]train AUC: 0.80697 ACC: 0.83715
test AUC: 0.81433 ACC: 0.83665
dev AUC: 0.81538 ACC: 0.81928
 85%|████████▌ | 85/100 [1:12:52<12:53, 51.55s/it]train AUC: 0.82678 ACC: 0.83765
test AUC: 0.86169 ACC: 0.87649
 86%|████████▌ | 86/100 [1:13:44<12:04, 51.74s/it]dev AUC: 0.83558 ACC: 0.80723
train AUC: 0.81863 ACC: 0.83267
test AUC: 0.87881 ACC: 0.84064
dev AUC: 0.83447 ACC: 0.78313
 87%|████████▋ | 87/100 [1:14:36<11:15, 51.97s/it]train AUC: 0.8284 ACC: 0.83466
test AUC: 0.8408 ACC: 0.88446
 88%|████████▊ | 88/100 [1:15:28<10:23, 51.95s/it]dev AUC: 0.77206 ACC: 0.76707
train AUC: 0.82144 ACC: 0.83566
test AUC: 0.83532 ACC: 0.87649
 89%|████████▉ | 89/100 [1:16:20<09:31, 51.93s/it]dev AUC: 0.78995 ACC: 0.80321
train AUC: 0.78511 ACC: 0.81474
test AUC: 0.71682 ACC: 0.79681
dev AUC: 0.77256 ACC: 0.79518
 90%|█████████ | 90/100 [1:17:11<08:36, 51.68s/it]train AUC: 0.81298 ACC: 0.82371
test AUC: 0.88448 ACC: 0.88446
dev AUC: 0.80844 ACC: 0.82731
 91%|█████████ | 91/100 [1:18:04<07:46, 51.86s/it]train AUC: 0.82664 ACC: 0.83267
test AUC: 0.85045 ACC: 0.84861
dev AUC: 0.83156 ACC: 0.78313
 92%|█████████▏| 92/100 [1:18:55<06:54, 51.84s/it]train AUC: 0.82556 ACC: 0.84114
test AUC: 0.85871 ACC: 0.87649
 93%|█████████▎| 93/100 [1:19:48<06:03, 51.91s/it]dev AUC: 0.76834 ACC: 0.79116
train AUC: 0.84165 ACC: 0.84163
test AUC: 0.88507 ACC: 0.87649
 94%|█████████▍| 94/100 [1:20:40<05:11, 51.95s/it]dev AUC: 0.83206 ACC: 0.81928
train AUC: 0.83166 ACC: 0.83566
test AUC: 0.88766 ACC: 0.84064
 95%|█████████▌| 95/100 [1:21:32<04:20, 52.06s/it]dev AUC: 0.82593 ACC: 0.80321
train AUC: 0.83548 ACC: 0.84313
test AUC: 0.88279 ACC: 0.88446
 96%|█████████▌| 96/100 [1:22:24<03:28, 52.08s/it]dev AUC: 0.84965 ACC: 0.85141
train AUC: 0.83793 ACC: 0.83815
test AUC: 0.86995 ACC: 0.86853
 97%|█████████▋| 97/100 [1:23:16<02:35, 51.99s/it]dev AUC: 0.82653 ACC: 0.82731
train AUC: 0.82758 ACC: 0.84064
test AUC: 0.83025 ACC: 0.84861
 98%|█████████▊| 98/100 [1:24:09<01:44, 52.21s/it]dev AUC: 0.82704 ACC: 0.77912
train AUC: 0.8169 ACC: 0.83715
test AUC: 0.87582 ACC: 0.85259
dev AUC: 0.8204 ACC: 0.80321
 99%|█████████▉| 99/100 [1:24:59<00:51, 51.83s/it]train AUC: 0.82384 ACC: 0.81723
test AUC: 0.761 ACC: 0.77689
dev AUC: 0.7596 ACC: 0.78715
Finish at:  2021-06-09 16:43:22
epoch 12 is the best model with auc 0.91861 and acc 0.82869
==> Testing model...
100%|██████████| 100/100 [1:25:51<00:00, 51.52s/it]

Process finished with exit code 0
