C:\ProgramData\Anaconda3\python.exe C:/Users/CandyMonster/Desktop/EXPCLASS/内容安全/final/train.py
==> Preparing data...
Make data sets successfully!
kinds: 4
data nums: 2513
train nums: 2010
test nums: 252
dev nums: 251
Make dataloader successfully!
Data prepared!
==> Building and training model...
Begin at:  2021-06-09 17:44:35
  0%|          | 0/100 [00:00<?, ?it/s]train AUC: 0.53367 ACC: 0.30796
test AUC: 0.60061 ACC: 0.28968
dev AUC: 0.52883 ACC: 0.34274
  1%|          | 1/100 [00:50<1:23:54, 50.85s/it]train AUC: 0.545 ACC: 0.36517
test AUC: 0.50005 ACC: 0.36508
dev AUC: 0.59919 ACC: 0.36694
  2%|▏         | 2/100 [01:38<1:20:25, 49.24s/it]train AUC: 0.57535 ACC: 0.38358
test AUC: 0.6466 ACC: 0.41667
  3%|▎         | 3/100 [02:27<1:19:00, 48.87s/it]dev AUC: 0.59724 ACC: 0.43548
train AUC: 0.61703 ACC: 0.41095
test AUC: 0.69543 ACC: 0.44841
  4%|▍         | 4/100 [03:16<1:18:29, 49.06s/it]dev AUC: 0.64915 ACC: 0.41935
train AUC: 0.61455 ACC: 0.37512
test AUC: 0.68189 ACC: 0.45238
dev AUC: 0.61967 ACC: 0.32661
  5%|▌         | 5/100 [04:06<1:18:17, 49.45s/it]train AUC: 0.63381 ACC: 0.41642
test AUC: 0.65018 ACC: 0.41667
dev AUC: 0.66792 ACC: 0.43952
  6%|▌         | 6/100 [04:58<1:18:23, 50.04s/it]train AUC: 0.6326 ACC: 0.40846
test AUC: 0.67672 ACC: 0.4246
dev AUC: 0.65652 ACC: 0.41935
  7%|▋         | 7/100 [05:47<1:17:25, 49.96s/it]train AUC: 0.62517 ACC: 0.40398
test AUC: 0.67062 ACC: 0.35714
dev AUC: 0.6487 ACC: 0.41532
  8%|▊         | 8/100 [06:39<1:17:12, 50.36s/it]train AUC: 0.61292 ACC: 0.40945
test AUC: 0.57495 ACC: 0.35317
dev AUC: 0.58165 ACC: 0.38306
  9%|▉         | 9/100 [07:28<1:15:54, 50.05s/it]train AUC: 0.61609 ACC: 0.40945
test AUC: 0.56887 ACC: 0.43254
dev AUC: 0.67003 ACC: 0.46774
 10%|█         | 10/100 [08:17<1:14:47, 49.86s/it]train AUC: 0.58845 ACC: 0.38507
test AUC: 0.62881 ACC: 0.4127
dev AUC: 0.6122 ACC: 0.42742
 11%|█         | 11/100 [09:07<1:14:01, 49.90s/it]train AUC: 0.62647 ACC: 0.42289
test AUC: 0.62967 ACC: 0.39683
dev AUC: 0.64834 ACC: 0.43145
 12%|█▏        | 12/100 [09:57<1:13:04, 49.82s/it]train AUC: 0.63002 ACC: 0.42488
test AUC: 0.62979 ACC: 0.42857
 13%|█▎        | 13/100 [10:47<1:12:09, 49.76s/it]dev AUC: 0.70346 ACC: 0.45161
train AUC: 0.61396 ACC: 0.41194
test AUC: 0.66083 ACC: 0.43651
dev AUC: 0.63523 ACC: 0.40726
 14%|█▍        | 14/100 [11:36<1:11:14, 49.71s/it]train AUC: 0.62762 ACC: 0.4199
test AUC: 0.66999 ACC: 0.42063
dev AUC: 0.69139 ACC: 0.44355
 15%|█▌        | 15/100 [12:26<1:10:20, 49.65s/it]train AUC: 0.63315 ACC: 0.41891
test AUC: 0.64371 ACC: 0.42063
dev AUC: 0.67036 ACC: 0.47581
 16%|█▌        | 16/100 [13:16<1:09:38, 49.75s/it]train AUC: 0.56073 ACC: 0.36567
test AUC: 0.5594 ACC: 0.40079
 17%|█▋        | 17/100 [14:06<1:08:51, 49.77s/it]dev AUC: 0.59489 ACC: 0.39113
train AUC: 0.60508 ACC: 0.40547
test AUC: 0.60979 ACC: 0.40476
 18%|█▊        | 18/100 [14:56<1:08:11, 49.90s/it]dev AUC: 0.58232 ACC: 0.39516
train AUC: 0.5687 ACC: 0.35572
test AUC: 0.63526 ACC: 0.43651
 19%|█▉        | 19/100 [15:47<1:07:46, 50.20s/it]dev AUC: 0.57573 ACC: 0.33065
train AUC: 0.63685 ACC: 0.42886
test AUC: 0.65327 ACC: 0.39286
 20%|██        | 20/100 [16:37<1:06:51, 50.14s/it]dev AUC: 0.6435 ACC: 0.41532
train AUC: 0.63735 ACC: 0.42537
test AUC: 0.66948 ACC: 0.46032
dev AUC: 0.65642 ACC: 0.43952
 21%|██        | 21/100 [17:27<1:06:07, 50.22s/it]train AUC: 0.64208 ACC: 0.42836
test AUC: 0.64683 ACC: 0.46032
dev AUC: 0.66748 ACC: 0.46371
 22%|██▏       | 22/100 [18:18<1:05:25, 50.32s/it]train AUC: 0.62155 ACC: 0.40697
test AUC: 0.72095 ACC: 0.44048
dev AUC: 0.63601 ACC: 0.41129
 23%|██▎       | 23/100 [19:09<1:04:59, 50.65s/it]train AUC: 0.63808 ACC: 0.43234
test AUC: 0.61994 ACC: 0.39286
 24%|██▍       | 24/100 [20:02<1:05:13, 51.49s/it]dev AUC: 0.64552 ACC: 0.39516
train AUC: 0.63209 ACC: 0.42736
test AUC: 0.67955 ACC: 0.46429
dev AUC: 0.62014 ACC: 0.45161
 25%|██▌       | 25/100 [20:53<1:04:04, 51.26s/it]train AUC: 0.63266 ACC: 0.42786
test AUC: 0.6805 ACC: 0.45635
 26%|██▌       | 26/100 [21:44<1:03:07, 51.18s/it]dev AUC: 0.67429 ACC: 0.46774
train AUC: 0.64218 ACC: 0.42687
test AUC: 0.66469 ACC: 0.44841
dev AUC: 0.66438 ACC: 0.45565
 27%|██▋       | 27/100 [22:35<1:02:10, 51.10s/it]train AUC: 0.63554 ACC: 0.41841
test AUC: 0.63954 ACC: 0.34127
dev AUC: 0.61383 ACC: 0.33065
 28%|██▊       | 28/100 [23:25<1:01:03, 50.88s/it]train AUC: 0.64451 ACC: 0.4398
test AUC: 0.66348 ACC: 0.43254
dev AUC: 0.65357 ACC: 0.44758
 29%|██▉       | 29/100 [24:17<1:00:22, 51.02s/it]train AUC: 0.63867 ACC: 0.41095
test AUC: 0.6762 ACC: 0.37302
dev AUC: 0.63306 ACC: 0.31855
 30%|███       | 30/100 [25:09<59:50, 51.30s/it]  train AUC: 0.62996 ACC: 0.42886
test AUC: 0.67973 ACC: 0.38889
 31%|███       | 31/100 [26:00<59:02, 51.35s/it]dev AUC: 0.65066 ACC: 0.43952
train AUC: 0.65815 ACC: 0.43184
test AUC: 0.69505 ACC: 0.43651
 32%|███▏      | 32/100 [26:51<57:52, 51.06s/it]dev AUC: 0.674 ACC: 0.43145
train AUC: 0.64249 ACC: 0.42587
test AUC: 0.67157 ACC: 0.39286
 33%|███▎      | 33/100 [27:43<57:19, 51.33s/it]dev AUC: 0.6517 ACC: 0.38306
train AUC: 0.64946 ACC: 0.43682
test AUC: 0.64637 ACC: 0.47619
 34%|███▍      | 34/100 [28:35<56:48, 51.64s/it]dev AUC: 0.65165 ACC: 0.49597
train AUC: 0.62283 ACC: 0.40299
test AUC: 0.6532 ACC: 0.42857
dev AUC: 0.67969 ACC: 0.45565
 35%|███▌      | 35/100 [29:26<55:52, 51.58s/it]train AUC: 0.6321 ACC: 0.41144
test AUC: 0.68334 ACC: 0.44841
 36%|███▌      | 36/100 [30:21<56:00, 52.51s/it]dev AUC: 0.64444 ACC: 0.42742
train AUC: 0.63959 ACC: 0.43383
test AUC: 0.6732 ACC: 0.41667
 37%|███▋      | 37/100 [31:12<54:46, 52.17s/it]dev AUC: 0.65472 ACC: 0.45161
train AUC: 0.62364 ACC: 0.41841
test AUC: 0.66695 ACC: 0.39286
 38%|███▊      | 38/100 [32:05<53:55, 52.18s/it]dev AUC: 0.64058 ACC: 0.42339
train AUC: 0.65233 ACC: 0.44179
test AUC: 0.68621 ACC: 0.45238
dev AUC: 0.6842 ACC: 0.46371
 39%|███▉      | 39/100 [32:56<52:54, 52.05s/it]train AUC: 0.63536 ACC: 0.40498
test AUC: 0.68713 ACC: 0.38889
 40%|████      | 40/100 [33:48<51:48, 51.81s/it]dev AUC: 0.63195 ACC: 0.41935
train AUC: 0.63421 ACC: 0.42289
test AUC: 0.69579 ACC: 0.46032
dev AUC: 0.66676 ACC: 0.46774
 41%|████      | 41/100 [34:39<50:54, 51.77s/it]train AUC: 0.64779 ACC: 0.4393
test AUC: 0.66129 ACC: 0.41667
dev AUC: 0.65978 ACC: 0.40726
 42%|████▏     | 42/100 [35:30<49:49, 51.55s/it]train AUC: 0.65631 ACC: 0.45323
test AUC: 0.67859 ACC: 0.47222
 43%|████▎     | 43/100 [36:21<48:42, 51.28s/it]dev AUC: 0.686 ACC: 0.41935
train AUC: 0.65104 ACC: 0.43035
test AUC: 0.66481 ACC: 0.4127
 44%|████▍     | 44/100 [37:18<49:27, 53.00s/it]dev AUC: 0.65992 ACC: 0.43145
train AUC: 0.64356 ACC: 0.4194
test AUC: 0.68239 ACC: 0.42857
dev AUC: 0.66013 ACC: 0.41532
 45%|████▌     | 45/100 [38:10<48:18, 52.70s/it]train AUC: 0.65649 ACC: 0.43284
test AUC: 0.69469 ACC: 0.41667
 46%|████▌     | 46/100 [39:04<47:43, 53.02s/it]dev AUC: 0.67278 ACC: 0.43145
train AUC: 0.65292 ACC: 0.43881
test AUC: 0.66468 ACC: 0.38492
 47%|████▋     | 47/100 [39:58<47:09, 53.39s/it]dev AUC: 0.65869 ACC: 0.41532
train AUC: 0.66694 ACC: 0.43234
test AUC: 0.70051 ACC: 0.50794
dev AUC: 0.69826 ACC: 0.43952
 48%|████▊     | 48/100 [40:51<46:13, 53.34s/it]train AUC: 0.66847 ACC: 0.44975
test AUC: 0.66477 ACC: 0.48016
 49%|████▉     | 49/100 [41:44<45:07, 53.09s/it]dev AUC: 0.71387 ACC: 0.4879
train AUC: 0.65975 ACC: 0.45572
test AUC: 0.67382 ACC: 0.45635
dev AUC: 0.67722 ACC: 0.43548
 50%|█████     | 50/100 [42:35<43:52, 52.65s/it]train AUC: 0.65931 ACC: 0.43134
test AUC: 0.70003 ACC: 0.48016
 51%|█████     | 51/100 [43:29<43:15, 52.96s/it]dev AUC: 0.69107 ACC: 0.45968
train AUC: 0.65234 ACC: 0.43582
test AUC: 0.67942 ACC: 0.48016
dev AUC: 0.63811 ACC: 0.46774
 52%|█████▏    | 52/100 [44:22<42:14, 52.81s/it]train AUC: 0.64953 ACC: 0.43433
test AUC: 0.69384 ACC: 0.46825
 53%|█████▎    | 53/100 [45:14<41:16, 52.70s/it]dev AUC: 0.66738 ACC: 0.44758
train AUC: 0.65194 ACC: 0.42985
test AUC: 0.66479 ACC: 0.34921
dev AUC: 0.63632 ACC: 0.38306
 54%|█████▍    | 54/100 [46:05<40:06, 52.32s/it]train AUC: 0.66673 ACC: 0.45025
test AUC: 0.68579 ACC: 0.44048
dev AUC: 0.66408 ACC: 0.45565
 55%|█████▌    | 55/100 [46:56<38:51, 51.82s/it]train AUC: 0.66555 ACC: 0.44478
test AUC: 0.67352 ACC: 0.52381
 56%|█████▌    | 56/100 [47:47<37:51, 51.62s/it]dev AUC: 0.67066 ACC: 0.43145
train AUC: 0.66999 ACC: 0.44726
test AUC: 0.70466 ACC: 0.45238
 57%|█████▋    | 57/100 [48:38<36:44, 51.27s/it]dev AUC: 0.69499 ACC: 0.43952
train AUC: 0.66664 ACC: 0.45423
test AUC: 0.71192 ACC: 0.5119
 58%|█████▊    | 58/100 [49:29<36:00, 51.44s/it]dev AUC: 0.68865 ACC: 0.46371
train AUC: 0.67456 ACC: 0.44627
test AUC: 0.72261 ACC: 0.44048
 59%|█████▉    | 59/100 [50:21<35:13, 51.56s/it]dev AUC: 0.67653 ACC: 0.42742
train AUC: 0.67717 ACC: 0.47065
test AUC: 0.68459 ACC: 0.4127
 60%|██████    | 60/100 [51:13<34:28, 51.72s/it]dev AUC: 0.66821 ACC: 0.36694
train AUC: 0.66884 ACC: 0.42637
test AUC: 0.6811 ACC: 0.45635
dev AUC: 0.67989 ACC: 0.40323
 61%|██████    | 61/100 [52:05<33:31, 51.59s/it]train AUC: 0.67139 ACC: 0.44776
test AUC: 0.6759 ACC: 0.46825
dev AUC: 0.67179 ACC: 0.41129
 62%|██████▏   | 62/100 [52:56<32:35, 51.46s/it]train AUC: 0.67475 ACC: 0.4408
test AUC: 0.67236 ACC: 0.45238
dev AUC: 0.6903 ACC: 0.47984
 63%|██████▎   | 63/100 [53:47<31:39, 51.35s/it]train AUC: 0.68029 ACC: 0.45323
test AUC: 0.69386 ACC: 0.43651
 64%|██████▍   | 64/100 [54:38<30:49, 51.37s/it]dev AUC: 0.68658 ACC: 0.46371
train AUC: 0.67157 ACC: 0.45124
test AUC: 0.70902 ACC: 0.49206
 65%|██████▌   | 65/100 [55:31<30:11, 51.76s/it]dev AUC: 0.70745 ACC: 0.44758
train AUC: 0.67561 ACC: 0.45522
test AUC: 0.68246 ACC: 0.39286
 66%|██████▌   | 66/100 [56:24<29:36, 52.24s/it]dev AUC: 0.65566 ACC: 0.39113
train AUC: 0.66811 ACC: 0.44826
test AUC: 0.70396 ACC: 0.4246
 67%|██████▋   | 67/100 [57:17<28:47, 52.34s/it]dev AUC: 0.65859 ACC: 0.41129
train AUC: 0.67721 ACC: 0.46816
test AUC: 0.7001 ACC: 0.51587
 68%|██████▊   | 68/100 [58:12<28:18, 53.08s/it]dev AUC: 0.65913 ACC: 0.41532
train AUC: 0.68248 ACC: 0.46517
test AUC: 0.70994 ACC: 0.4881
dev AUC: 0.69945 ACC: 0.44355
 69%|██████▉   | 69/100 [59:05<27:29, 53.22s/it]train AUC: 0.67068 ACC: 0.44726
test AUC: 0.71395 ACC: 0.52778
 70%|███████   | 70/100 [59:59<26:42, 53.40s/it]dev AUC: 0.65657 ACC: 0.43145
train AUC: 0.67606 ACC: 0.44925
test AUC: 0.73373 ACC: 0.55556
 71%|███████   | 71/100 [1:00:52<25:46, 53.31s/it]dev AUC: 0.70026 ACC: 0.43145
train AUC: 0.68096 ACC: 0.45274
test AUC: 0.6878 ACC: 0.44841
 72%|███████▏  | 72/100 [1:01:46<24:51, 53.29s/it]dev AUC: 0.66855 ACC: 0.47177
train AUC: 0.67635 ACC: 0.47313
test AUC: 0.67721 ACC: 0.47222
 73%|███████▎  | 73/100 [1:02:39<24:01, 53.40s/it]dev AUC: 0.66896 ACC: 0.46774
train AUC: 0.681 ACC: 0.45423
test AUC: 0.67702 ACC: 0.44841
 74%|███████▍  | 74/100 [1:03:32<23:00, 53.11s/it]dev AUC: 0.63771 ACC: 0.3871
train AUC: 0.67233 ACC: 0.45323
test AUC: 0.72949 ACC: 0.45238
dev AUC: 0.62262 ACC: 0.42742
 75%|███████▌  | 75/100 [1:04:23<21:51, 52.48s/it]train AUC: 0.67754 ACC: 0.44279
test AUC: 0.71194 ACC: 0.49603
 76%|███████▌  | 76/100 [1:05:14<20:49, 52.05s/it]dev AUC: 0.68329 ACC: 0.39113
train AUC: 0.68869 ACC: 0.46219
test AUC: 0.70751 ACC: 0.45635
 77%|███████▋  | 77/100 [1:06:05<19:49, 51.71s/it]dev AUC: 0.65896 ACC: 0.45565
train AUC: 0.68315 ACC: 0.47065
test AUC: 0.70114 ACC: 0.48413
dev AUC: 0.68178 ACC: 0.46774
 78%|███████▊  | 78/100 [1:06:58<19:08, 52.23s/it]train AUC: 0.68272 ACC: 0.44677
test AUC: 0.70308 ACC: 0.52381
dev AUC: 0.67453 ACC: 0.3871
 79%|███████▉  | 79/100 [1:07:50<18:17, 52.26s/it]train AUC: 0.68416 ACC: 0.46219
test AUC: 0.68068 ACC: 0.4246
dev AUC: 0.65018 ACC: 0.3629
 80%|████████  | 80/100 [1:08:43<17:28, 52.40s/it]train AUC: 0.68799 ACC: 0.47264
test AUC: 0.71298 ACC: 0.47619
dev AUC: 0.66246 ACC: 0.39113
 81%|████████  | 81/100 [1:09:36<16:36, 52.42s/it]train AUC: 0.68769 ACC: 0.46269
test AUC: 0.69852 ACC: 0.46429
 82%|████████▏ | 82/100 [1:10:27<15:39, 52.21s/it]dev AUC: 0.68162 ACC: 0.47581
train AUC: 0.69271 ACC: 0.46766
test AUC: 0.70959 ACC: 0.50794
 83%|████████▎ | 83/100 [1:11:18<14:38, 51.70s/it]dev AUC: 0.68769 ACC: 0.45161
train AUC: 0.68034 ACC: 0.46119
test AUC: 0.72847 ACC: 0.5119
 84%|████████▍ | 84/100 [1:12:09<13:43, 51.49s/it]dev AUC: 0.6485 ACC: 0.46774
train AUC: 0.69169 ACC: 0.46766
test AUC: 0.71549 ACC: 0.50397
 85%|████████▌ | 85/100 [1:12:59<12:47, 51.16s/it]dev AUC: 0.65064 ACC: 0.375
train AUC: 0.68962 ACC: 0.46368
test AUC: 0.68953 ACC: 0.43651
dev AUC: 0.63946 ACC: 0.39919
 86%|████████▌ | 86/100 [1:13:50<11:55, 51.12s/it]train AUC: 0.6861 ACC: 0.46169
test AUC: 0.70046 ACC: 0.48413
dev AUC: 0.66486 ACC: 0.39919
 87%|████████▋ | 87/100 [1:14:45<11:18, 52.15s/it]train AUC: 0.69841 ACC: 0.48259
test AUC: 0.70249 ACC: 0.46825
dev AUC: 0.64976 ACC: 0.37903
 88%|████████▊ | 88/100 [1:15:39<10:35, 52.92s/it]train AUC: 0.70248 ACC: 0.48955
test AUC: 0.70452 ACC: 0.44841
dev AUC: 0.64703 ACC: 0.3871
 89%|████████▉ | 89/100 [1:16:31<09:37, 52.49s/it]train AUC: 0.68469 ACC: 0.45672
test AUC: 0.70406 ACC: 0.4881
 90%|█████████ | 90/100 [1:17:24<08:47, 52.80s/it]dev AUC: 0.68946 ACC: 0.375
train AUC: 0.68395 ACC: 0.47264
test AUC: 0.69985 ACC: 0.43651
 91%|█████████ | 91/100 [1:18:19<07:59, 53.33s/it]dev AUC: 0.6507 ACC: 0.3871
train AUC: 0.69751 ACC: 0.46866
test AUC: 0.7033 ACC: 0.5119
dev AUC: 0.68117 ACC: 0.45161
 92%|█████████▏| 92/100 [1:19:12<07:06, 53.34s/it]train AUC: 0.68587 ACC: 0.46219
test AUC: 0.72836 ACC: 0.4881
dev AUC: 0.66683 ACC: 0.43145
 93%|█████████▎| 93/100 [1:20:05<06:12, 53.20s/it]train AUC: 0.68598 ACC: 0.46915
test AUC: 0.70042 ACC: 0.44048
 94%|█████████▍| 94/100 [1:20:58<05:18, 53.09s/it]dev AUC: 0.65082 ACC: 0.42742
train AUC: 0.6815 ACC: 0.46119
test AUC: 0.71702 ACC: 0.50794
 95%|█████████▌| 95/100 [1:21:50<04:24, 52.81s/it]dev AUC: 0.67019 ACC: 0.39516
train AUC: 0.69591 ACC: 0.4791
test AUC: 0.68213 ACC: 0.44841
 96%|█████████▌| 96/100 [1:22:41<03:29, 52.33s/it]dev AUC: 0.67889 ACC: 0.43145
train AUC: 0.68908 ACC: 0.45174
test AUC: 0.67744 ACC: 0.43254
 97%|█████████▋| 97/100 [1:23:34<02:37, 52.40s/it]dev AUC: 0.63827 ACC: 0.36694
train AUC: 0.68782 ACC: 0.47015
test AUC: 0.69879 ACC: 0.42063
 98%|█████████▊| 98/100 [1:24:28<01:45, 52.78s/it]dev AUC: 0.64591 ACC: 0.41935
train AUC: 0.69072 ACC: 0.46517
test AUC: 0.70606 ACC: 0.42063
 99%|█████████▉| 99/100 [1:25:19<00:52, 52.44s/it]dev AUC: 0.66777 ACC: 0.37097
train AUC: 0.68698 ACC: 0.45821
test AUC: 0.76992 ACC: 0.54762
100%|██████████| 100/100 [1:26:11<00:00, 51.71s/it]
dev AUC: 0.64724 ACC: 0.3629
Finish at:  2021-06-09 19:10:48
epoch 99 is the best model with auc: 0.76992 and acc: 0.54762
==> Testing model...

Process finished with exit code 0
